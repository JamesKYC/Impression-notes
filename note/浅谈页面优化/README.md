# 浅谈页面优化

## 前期准备

1. 首页命名为index.html / index.htm / index.php等。
2. 需要制作404页面。
3. 文件夹结构合理。
4. 命名使用英文且有语义性的单词，并提供参考文档。

## 结构

### 文件头部分

1. 需要提供文档声明
2. 设置utf-8的编码格式，并放置于title之上
3. 合理的填写html文件中的title、meta等内容
4. 使用外部引入样式表和JS行为代码，实现结构、样式和行为的相分离，降低模块间的耦合度
5. 合理控制JS文件的引入位置，提升网站的加载速度
6. 根据具体情况合并CSS、JS文件，降低服务器请求次数

### 标签选用与书写规范

1. 书写HTML代码的时候，遵循标签语义化的要求，根据标签的语义性进行选择，如布局使用div、标题使用h系列标签、段落使用p标签等
2. HTML代码要合理嵌套，一般情况下，行元素当中不能包含块元素，除了段落、标题类型的块元素当中，既能够包含块元素，也能够包含行元素，而段落或标题类的块元素只能够包含文字或行元素。table元素只能够直接包含thead、tbody、tfoot、caption等元素；ul/ol元素只能直接包含li元素；dl元素当中只能直接包含dt和dd元素；form表单当中只能直接包含filedset和legend，不能直接包含input元素。
3. 合理书写注释，代码缩进合理，不出现多余空行或者空标签，提升代码可读性。
4. 权衡嵌套层级以及扩展性等多个方面后，在适当位置使用三层嵌套技术。
5. 合理书写a标签的title、img标签的title和alt，提升网站的SEO。

## 样式

### 基本代码规范

1. CSS规则命名中，一律采用小写加中划线的方式，不使用下划线或大写字母，命名采用更简明有语义的英文单词进行组合，进行合理.的缩写
2. CSS代码的书写顺序遵循CSS样式的渲染顺序：显示属性-自身属性-文本属性-其他。
3. 避免class与id重名，对于class名使用中划线，而id名遵循小驼峰命名法。
4. 在书写网页样式之前，先进行浏览器默认样式重置。

### 兼容问题处理

1. 在CSS代码当中，尽量的规避掉不同浏览器的兼容问题，如果实在避免不了，也需要进行合理解决。
2. 尽可能的少使用hack。
3. 对于CSS3部分属性，如果需要兼容各个浏览器，需要书写各个浏览器前缀。

### 其他样式处理

1. 合理使用样式的“继承”（CSS后代选择器），或者使用样式的“组合”，减少页面中的类名，提升通用性。
2. 合理使用群组选择器，进行代码的优化。
3. 图片需要设置大小，防止后台传送不正常尺寸图像造成的失真。
4. 对于数据类部分，在适当的地方增加超出隐藏或者超出显示为省略号。
5. 需要考虑a标签的点击区，通常会对a进行处理：转化为块元素并设置高度，或者浮动设置宽高。
6. 合理利用元素的默认样式，而不再进行冗余设置（如div等元素的宽度默认为占满父级，就不需要再设置width:100%，对于高度，默认由内容撑开，也不需要设置高度）。
7. 考虑文档流的变化，对元素进行浮动之后，需要进行及时的清除，采用after伪元素清浮动的方法进行清除。
8. 对盒模型设置时，子级的margin（顶部）通常会影响父级样式，因此，在父子之间的间距使用父级的内边距撑开，兄弟级别标签之间的距离可采用外边距。

## JS方面

### 变量

1. 合理命名，遵循基本的命名规范，并遵循命名推荐：属性/变量以名词开头，方法/函数以动词开头，遵循小驼峰，构造函数使用大驼峰，常量所有字母均大写。
2. 所有变量声明都放在函数的头部。
3. 所有函数都在使用之前定义。
4. 尽量避免使用全局变量，防止全局作用域被污染。
5. 合理书写大括号位置、空行位置、注释等内容，对于声明变量，可以如下声明：

```js
var box = document.getElementById('box'),
    con = document.getElementById('con');
```

6. 利用对象命名空间、匿名函数、协同命名等方法，尽量避免团队合作时产生的命名冲突。
7. 文件加载完毕之后再进行代码的执行，合理利用window.onload与jQuery中的$(document).ready。
8. 对于DOM操作，尽可能减少在页面中查找元素的次数，即用变量存储查找的元素，之后再需使用，只需要使用变量即可（for循环中常见的长度控制，同理）。

### 数据类型

1. 比较数据时，不要使用"相等"（\==）运算符，只使用"严格相等"（===）运算符。
2. 不要使用隐式的数据类型转换。
3. 追加字符串时，采用 str += "独行冰海"; 而不是str = str + "独行冰海";

### 页面基本数据交互

1. 获取标签使用最为快捷的方法，在PC端原生方法当中，速度比较如下：通过id > 通过类名 > 通过标签名。如果能够在小范围中进行查找时则缩小范围。
2. 对于样式的修改与调整，根据具体情况采用style或者类名操作（className），防止style的滥用造成的css文件hover失效。
3. 原生当中，一个元素一种事件只能绑定一次。
4. 可以通过事件委托，减少页面中类似事件的数量。
5. 在删除dom节点之前，需要先移除掉该节点上的事件。

## 性能

1. 对于功能类似的代码，进行函数的封装，可以使用面向对象的书写方法，提升代码的复用性和扩展性。
2. 尽可能少使用with语句、闭包、eval语句。
3. 在DOM节点相关操作上进行优化，如利用变量存储查找到的元素，从而防止每次查找时进行页面重绘、利用文档碎片等。
4. 尽可能减少页面中dom元素样式的修改，防止页面回流与重绘。
5. 合理使用计时器，防止setInterval造成的内存泄露。
6. 在设置计时器之后需要考虑计时器的清除，以防止计时器的叠加造成的影响。

## AJAX

1. 对于AJAX的异步加载，提供加载的相关提醒。
2. 防止AJAX造成的重复请求。
3. 利用时间戳进行缓存的处理。
4. 对AJAX进行缓存处理。
5. 合理使用AJAX中发送数据的方法，当文档中允许使用post或get发送时，优选选用get方法。

## 框架

1. jQuery等插件的合理引用，处理常见的浏览器兼容问题。
2. 根进jQuery的发展，及时更新文件库，舍弃已经淘汰的方法（如：.toggle()，.live()等）。

## 图像方面

1. 使用背景图合并技术，将多张背景图合并到一张图片上，从而降低页面与服务器之间的请求次数。
2. 存储图像时根据需求采取不同的格式，对于不需要透明的图像可以存储为jpg，需要半透明图像存储为png，对于全透明且像素要求不高的图像可以存储为gif或png-8。对图像质量进行控制，保证在显示效果正常的前提下，存储为尽可能小的图像，对于含透明的图像，需要根据具体显示质量而选择。
3. 对于网页中特殊的字体，可以使用@font-face进行设置，并根据实际情况修改字体包，防止字体包文件过大。。
4. 合理使用图片预加载和图片懒加载。

## 上线准备

1. 在上线之前对html、css、js文件进行压缩。
2. 增加网页图标 ico文件

## 自我思考

有时候会听到什么前端处理高并发的，这个题本身我不是很明白前端真的能处理高并发吗，高并发因该是服务器资源的调配。他们给出的解释是把图片放到cdn，合并请求，在页面根据时间让用户点击生成假请求（其实就是我点击后，不是马上发出请求，而是把这个时间往后推移，反正就是你抢红包手速快没用，还要运气好）。

其实项目中更多的优化，我的理解还是很依靠项目的，在chrome浏览器上看你的页面在在什么时间段花费的时间很长，怎么去优化这个时间段所执行的一些函数，或者请求。上面所说的基本大家在项目构建的时候就已经做好了。